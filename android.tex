%% android.tex
%% by Simon Danner

% The Computer Society requires 12pt.
\documentclass[12pt,journal,compsoc]{IEEEtran}
\usepackage[ngerman]{babel}   
\usepackage[utf8]{inputenc}   % UTF8-Kodierung für Umlaute
\usepackage{hyperref}         % Hyperlinks
\usepackage{listings}
\usepackage{graphicx}
\usepackage{color}
\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}

\clubpenalty = 10000           % Keine "Schusterjungen"
\widowpenalty = 10000          % Keine "Hurenkinder"

\selectlanguage{ngerman}

\input{android_commands.tex}

% korrigiere Silbentrennung % Kann man auch dazu verwendet die Silbentrennung zu deaktivieren
\hyphenation{op-tical net-works semi-conduc-tor}
% Silbentrennung für ein einzelnes Wort deaktivieren geht mit:
% \mbox{wort}

\definecolor{mybgcolor}{HTML}{DFF56C}

\lstset{
	backgroundcolor=\color{mybgcolor},
	basicstyle=\footnotesize,
	breakatwhitespace=false,
	breaklines=false,
	commentstyle=\color{blue}
}


% Bei einem zwei Spalten Layout versucht Latex auf beide Seiten die gleiche Texthöhe hinzubekommen
% Dies verursacht leider manchmal Leeräume z. B. zwischen der Überschrift und dem Text
% Mit der Option \raggedbottom kann dies unterbunden werdne
% Hat aber den Nachteil das das Dokument so einen unregelmäßigen Seitenfuß hat
% Aber immer noch besser wie die Leerräume
%\raggedbottom

\begin{document}

\title{\paperTitle \\ \paperSubTitle }
\author{\paperAuthor,~\IEEEmembership{ AI7 }}% <-this % stops a space

% The paper headers
% \markboth{Journal of \LaTeX\ Class Files,~Vol.~6, No.~1, January~2007}
% {Shell \MakeLowercase{\textit{et al.}}: Bare Advanced Demo of IEEEtran.cls for Journals}

\IEEEtitleabstractindextext{%
	\begin{abstract}
		In diesem Paper werden verschiedene Möglichkeiten der Anbindung von externen Geräten mit Android Geräten betrachtet. Dabei liegt der Fokus auf dem Android Open Accessory Protokoll. Das Protokoll wird beschrieben und für eine Beispielsanwendung, welche das IOIO Board verwendet benutzt.
		Dabei soll gezeigt werden, wie es App-Entwicklern mit den Standard Android Tools durch AOA möglich wird mit Hardware zu interagieren.
	\end{abstract}

	% Note that keywords are not normally used for peerreview papers.
	\begin{IEEEkeywords}
		Android, Hardware, Arduino, IOIO, ADK, ADK 2012, AOA, Mikrocontroller   
	\end{IEEEkeywords}
}

\maketitle

\section{Einleitung}


\IEEEPARstart{A}{}ndroid ist mit einem Marktanteil von ca. 85\% nach IDC das zur Zeit am weitesten verbreitete Smartphone und Tablet Betriebssystem.\cite{marketshare}
Android wird auf Smartphones, Tablets, Smartwatches, Fernsehern und anderen Geräten verwendet.
In vielen Geräten auf denen Android verwendet wird, gibt es zahlreiche Sensoren, wie Kameras, GPS, Mikrofone und ähnliches.
Die weite Verbreitung und die Austattung und Mobilität der Hardware, machen Android Geräte für eine Vielzahl von Anwendungen, bei denen externe Peripherie angeschlossen werden soll, interessant.
Für Entwickler von Systemen auf Mikrocontroller Basis gibt es die Möglichkeit Daten von angeschlossenen Android Geräten zu verwenden, oder diese als Kontrollgerät zu nutzen.
Andererseits ermöglicht die Anbindung von externen Geräten für Entwickler welche sich mit Smartphone Apps beschäftigen die Verwirklichung ganz neuer Kategorien von Applikation. 
So können zum Beispiel Anwendungen in den Bereichen Quantified Self und Hausautomation realisiert werden. 
Heute können Entwickler von Hardware über mehrere Möglichkeiten ihre eigene Geräte mit Android Geräten verbinden.


% Datum
\hfill{\the\day~\Monat, \the\year  }

\section{Allgemeines}
In diesem Paper sollen verschiedene Möglichkeiten der Verbindung von Android Geräten mit externen Geräten aufgezeigt und analysiert werden.
Dabei liegt der Fokus im Bereich der externen Geräte, welche mit Mikrocontroller Systemen umgesetzt sind, da mit ihnen Hardwareprojekte und Prototypen auch von Amateuren entwickelt und umgesetzt werden können.

\section{Anbindungsmöglichkeiten}
Um Android Geräte mit Peripherie Geräten zu verbinden, gibt es mittlerweile mehrere Möglichkeiten.
Diese decken ein großes Spektrum an realisierbaren Anwendungen ab, wobei bei jeder Realisierung zuerst die Vorteile und Nachteile der Anbindungen analysiert werden sollte.
Nach ersten experimentellen Ansätzen von Hobbyentwicklern und einzelnen Firmen, hat auch Google den Nutzen einfacher Verbindung mit externen Geräten 
erkannt und bietet seit 2011 ein offiziell unterstütztes Protokoll, was die Entwicklung vereinfacht.
Dabei ist neben den verbreiteten, hardwareunabhängigen Verbindungsmöglichkeiten wie Bluetooth und NFC vor allem die Anbindung über das AOA Protokoll interessant. 

\section{Bluetooth}
Mit dem Bluetooth Standard ist es seit den 90er Jahren möglich, Geräte miteinander über Funk zu verbinden. Bluetoothschnittstellen gehören schon lange zur Standardaustattung bei Handys, Smartphones und Zusatzgeräten wie Headsets.
Die weite Verbreitung macht Bluetooth für Hardwarehersteller von Unterhaltungselektronik sehr attraktiv, da die Hardware meist einfach auf allen Betriebssystemen verwendbar ist.
Zwar müssen für spezielle Geräte Treiber entwickelt werden, jedoch ist die Unterstützung für Standardgeräte wie Headsets oder Lautsprecher schon in den Betriebssystemen enthalten.

Der Standard beihaltet hierfür sogenannte Profile, welche festlegen wie die Geräte untereinander kommunizieren.
Beispiele hierfür sind Profile wie HID und OBEX (Datei Transfer). 
Durch diese Standardisierung ist sichergestellt dass die Geräte untereinander kompatibel sind.
\cite{bluetooth}

Zur Anbindung von selbst entwickelter Hardware ist Bluetooth aber nur bedingt geeignet, da die elektro-technische Umsetzung recht teure Chips erfordert, und ein Bluetooth Softwarestack sehr kompliziert ist. Außerdem ist der Stromverbrauch zur Übermittlung der Signale recht hoch.
Zwar ist der Stromverbrauch bei einer Übertragung von Daten über Bluetooth gering, wenn man aber die begrenzte Bandbreite berücksichtigt, hat Bluetooth gegenüber WI-Fi einen in etwa 10-fachen Stromverbrauch.\cite{wireless}
Es ist also nur für Übertragungen mit geringer Bandbreite geeignet, dort bietet es aber auf Grund der einfachen Bedienung eine nutzerfreundliche Möglichkeit der Vernetzung.

\subsection{Bluetooth Low Energy}
Um die Probleme von Bluetooth bezüglich des Stromverbrauches zu adressieren, wurde 2009 Bluetooth Low Energy, kurz Bluetooth LE, als optionaler Teil des Bluetooth Standard Version 4.0 eingeführt.  
Ziel von BLE ist es, den Stromverbrauch mittels darauf optimierter Protokolle und anderer Einschränkungen gegenüber Bluetooth zu verringern.
Die Komplexität wird unter anderem durch die Verringerung der unterstützen Profile erreicht. Klassische Bluetooth Profile wie zum Beispiel HSP (Headset), OBEX (Datei Übertragungen) und FTP (Datei Übertragungen) sind beispielsweise nicht mehr im Standard enthalten.
Energie wird durch ein neues Kommunikationsprotokoll gespart, bei der die Geräte im Standby(auf Verbindung wartend) mit weniger Energie auskommen.
Die Geräte können über eine Distanz von circa 10 Metern miteinander kommunizieren.
Mit Bluetooth 4.0 wurde auch eine neue Kommunikationsmethode, das Attribut Protokol (ATT) eingeführt, welches von Bluetooth LE verwendet und auf kleine Packetgrößen optimiert ist. 
Das minimiert den Protokolloverhead.
Die unterstützten Profile bauen alle auf GATT auf, welches ATT benutzt um Profile bereitzustellen.


In Smartphones wurde BLE in nennenswertem Umfang zuerst von Apple mit iOS 5 ( Oktober 2011)unterstützt.
Dabei besitzen die Geräte sogenannte Dual-mode Bluetooth Schnittstellen, die sowohl die klassische Bluetooth als auch BLE Geräte unterstützen.
Bei Android wurde die dieses Bluetooth LE Unterstützung in der Version 4.3 (Release Juli 2013) eingeführt.


\section{Near Field Communication}
Near Field Communication (NFC) ist ein Standard zu Datenübertragung über sehr kurze Strecken ( wenige Zentimeter). 
NFC findet vor allem in verschiedenen Zahlungssystemen Verwendung.
Bei diesen können Kunden mit Hilfe von Karten, welche einen NFC Chip enthalten Zahlungen tätigen.
Android unterstützt NFC seit Version 2.3. Allerdings besitzen nur wenige Smartphones die nötige NFC Hardware um NFC nutzen zu können.
Bei Android wird es auch für die Funktion Android Beam benutzt. 
Damit können Dateien von einem Android Gerät auf ein anderes übertragen werden können, ohne eine feste Verbindung einzurichten, welches auch ohne Konfiguration der Nutzer funktioniert.

\section{Audio}
Android unterstützt Entwickler bei der Einbindung von Audio Geräten. Das Verwalten der Hardware wird von Android komplett übernommen.
Falls gewünscht, können Entwickler von Audio Applikationen über den AudioManager herausfinden, was für Geräte angeschlossen sind. So kann man zum Beispiel die Lautstärke anpassen wenn ein Bluetooth Headset verbunden wird, oder Kopfhörer entfernt werden.

Da die Verwendung von Audio Geräten fast automatisch abläuft, wird hier nicht weiter auf Audio Geräte eingegangen.

Als Kuriosität können einige Entwicklungen, bei denen Audioausgabe zur Übermittlung an externe Geräte verwendet wird, betrachtet werden.
Diese sind im Normalfall jedoch in Anbetracht heutiger Möglichkeiten bei Neuentwicklungen nicht zu berücksichtigen.  
Ein Beispiel für ein solches Projekt ist Project HiJack \cite{hijack} , welches eine Hard- und Software Plattform zur Übermittlung von Signalen und Verarbeitung dieser auf Mikrocontrollern ermöglicht. 
Die Daten werden dabei analog übertragen und von dem empfangenden Gerät wieder digitalisiert.
Die Probleme hierbei sind vor allem die Komplexität, die begrenzte Bandbreite und die mangelnde Unterstützung seitens der Hersteller.

\section{USB}
Der Universal Serial Bus (USB), ist schon seit langem die am weitesten verbreitete Schnittstelle zwischen PCs und Peripheriegeräten.
Die USB Schnittstelle hat mittlerweile in vielen Bereichen wie z.B. der Anbindung von Mäusen, Tastaturen und Festplatten andere speziellere Schnittstellen verdrängt.
Auch die meisten Telefone besitzen seit geraumer Zeit USB-Schnittstellen. Diese wurden anfangs vor allem zur Übertragung von Daten von und zu PCs benutzt sowie für das Akku Laden.
Durch die Standardisierung der Anschlüsse und von Protokollen, hinzufügen und entfernen von Geräten im laufendem Betrieb und gute Softwareunterstützung ist USB für Anwender einfach zu bedienen.
USB ist ein serielles Bussystem, d. h. Daten werden sequentiell zwischen den Geräten übertragen. 
Die Koordination der angeschlossenen Geräte (Slaves) wird durch einen Controller (Master) übernommen.
Slaves dürfen nur Daten über den Bus schicken, wenn sie vom Master dazu aufgefordert werden.
Im normalen Gebrauch übernimmt der PC die Rolle des Masters, die Geräte sind Slaves. Die Stromversorgung der Slaves kann dabei über das gleiche Kabel durch den Master erfolgen, wenn der Verbrauch im Rahmen des Standards liegt (5V, 500mA bei USB v2).

Um mit USB angeschlossene Geräte verwenden zu können, muss der Master das Gerät identifizieren können. 
Die Erkennung läuft bei USB über sogenannte Deskriptoren. 
Der Device-Deskriptor enthält eine Hersteller-id, sowie eine Geräte id.
Im Device Deskriptor kann auch hinterlegt werden, ob das Gerät einer durch den Standard festgelegten Klasse angehört. 
Klassen gibt es zum Beispiel für Massenspeichergeräte, Drucker und Human Interface Devices (Maus, Tastatur usw.).
Das Betriebssystem kann dann anhand des Deskriptors passende Treiber laden. Wenn das Gerät zu einer Standardklasse gehört, kann einfach der allgemeine Treiber verwendet werden. Dies ist zum Beispiel bei USB Mäusen der Fall.
Falls das Gerät zu keiner Standardklasse gehört, muss ein gerätespezifischer Treiber bereitgestellt werden.
Zur Übermittlung von Daten stellen die Geräte virtuelle Schnittstellen bereit, welche ein oder mehrere adressierbare Endpunkte beinhalten. 

Endpunkte sind vom USB Interface bereitgestellte Adressen. An sie können Daten unidirektional übertragen werden.
Die Erkennung des Gerätes läuft über den Endpunkt mit der Adresse 0, danach werden die anderen Gerätespezifischen Endpunkte verwendet.

Die Kommunikation mit den Endpunkten kann über verschiedene Modi ablaufen.
Dabei unterscheiden sie sich zum Beispiel bei der Bestätigung von Nachrichten oder der Priorisierung.  

\subsection{USB On-The-Go}
USB On-The-Go (OTG) ist eine Spezifikation, die USB Geräten erlaubt dynamisch zwischen verschiedenen Modi zu wechseln. 
Im USB Standard USB Geräte entweder Host oder Slave, OTG bildet dazu eine Ausnahme, um größere Dynamik zu erlauben.
Geräte können ohne Host-Controller kommunizieren, indem eines der Geräte zum Host wird.
Dabei muss nur ein Teil der normalen Host Funktionalität bereitgestellt werden.

Mit einigen wenigen Androidgeräten kann OTG verwendet werden. Die verbaute USB Hardware muss dafür OTG unterstützen.
Vor allem Tablets ermöglichen OTG, damit man zum Beispiel Tastaturen, Drucker oder USB Sticks verwenden kann.
OTG ermöglicht es also Standard USB Geräte mit Android zu benutzen. Android unterstützt die durch den Linux Kernel unterstüzten USB Geräte. Eigene Hardware die mit der OTG Unterstützung kontrolliert werden könnte zu entwickeln, wäre denkbar aber durch die Komplexität von USB mit hohem Aufwand verbunden.
Es müsste ein Gerät entwickelt werden, welches eines der Standard USB Profile implementiert, jedoch die spezifizierten Kommandos nutzt um Funktionen umzusetzen.


\subsection{AOA (Android OpenAccessory)}
Android OpenAccessory ist der Name eines von Google entwickelten Protokolls, was 
dezidiert für die Anbindung von externen Geräten an Android Geräte entwickelt wurde.
Aufgrund der offiziellen Unterstützung und des Funktionsumfanges wird AOA hier detailliert vorgestellt.
Google stellt zum Einstieg das Accessory Development Kit (ADK) zu Verfügung mit der Entwickler relativ einfach Anwendungen die Software und Hardware kombinieren umsetzen können.
Mit Accessories sind elektronische Zusatzgeräte gemeint, welche in der Verbindung mit dem Androidgerät neue Funktionen für den Nutzer bereitstellen.
Das ADK besteht aus einer Hardware Referenz Plattform, sowie Quellcode für diese, damit 
Entwickler einfach Hardware und Software anpassen und erweitern können.
\cite{developaoa}
\subsubsection{Ziel}
Ziel Googles ist es mithilfe des AOA einen einheitlichen Standard zur Verbindung von externen, selbst entwickelten oder auch industriell hergestellten Geräten mit Android Geräten zu etablieren.

Dies führt dazu, dass Endanwender ohne spezielle Gerätskombinationen, externe Hardware verwenden können.
Google veröffentlichte bisher (Stand September 2014) zwei Versionen des ADKs, ADK 2011 und ADK 2012. 

\subsubsection{Geschichte}
Schon vor der Vorstellung des ADK gab es diverse Projekte, die das Ziel hatten Android mit Hardware auf Mikrocontroller Basis zu verbinden.
Der Standardweg dies zu bewerkstelligen war die Nutzung des Android Debug Bridge (ADB) Protokolls.
Die Unterstützung von ADB kann auf vielen Geräten vom Endanwender aktiviert werden. Dadurch kann eine Kompatibilität mit vielen Geräten erreicht werden, wenn die Kommunikation über dieses Protokoll abläuft. TODO ADB

Gegenüber der Kommunikation über das ADB Protokoll, bietet AOA einige Vorteile. In \ref{table:vergl} sind einige Kenngrößen gegenüber gestellt. Der größte Vorteil der Benutzung von AOA gegenüber ADB, besteht darin, dass AOA nicht explizit vom Benutzer eingeschaltet werden muss und offiziell unterstützt wird.


\begin{table}
	\centering
	\caption{Vergleich ADB / AOA Quelle: \cite{comp}}
	\label{table:vergl}
	\begin{tabular}{c | c | c}
		& ADB & AOA \\ \hline
		Latenz & 4ms & 1ms \\ \hline
		Durchsatz & 300 KB/s & 600 KB/s \\ \hline
		Verfügbarkeit & alle Versionen & \textgreater 2.3.4 \\ \hline
	\end{tabular}
\end{table}


\subsubsection{ADK 2011}
Beim ADK 2011 wurde von Google eine
Referenz Plattform auf Basis eines Arduino Mega2560 Mikrocontroller System, welches ein USB Host Modul enthält, sowie eine Arduino Bibliothek zur Kommunikation über AOA mit fähigen Android Geräten veröffentlicht.
Durch die Benutzung des Arduino Controllers ermöglicht es Google, Hobby Entwicklern einen einfachen Einstieg in die Entwicklung von Accessoires, da diese Mikrocontroller sehr verbreitet und es viel Software und Hardwaremodule für diese Systeme gibt.
So ist die Programmierung mit der Arduino IDE möglich, welche durch einen C-Dialekt gescheit, welcher auch für Anfänger einfach verständlich ist.
Die Android seitige Funktionalität von AOA wurde in Android 2.3.4 (Release April 2011) und spätere Versionen integriert. 
Um mit dem ADK eigene Accessoires entwickeln zu können, muss das Board zunächst mit der von Google bereitgestellten Firmware, welche AOA implementiert geflasht werden.
Danach kann mit der Arduino IDE 
TODO Beispiele
\subsubsection{ADK 2012}
In der zweiten Version des ADK wurde die Hardware Plattform gewechselt. Nun dient ein Arduino kompatibles Board mit einem ARM Cortex M3, Sensoren für Licht, Farbe, Temperatur, Feuchtigkeit, Druck und Beschleunigung, einem Micro SD Card Slot und Bluetooth als Referenzhardware.
Die neuen Sensoren und Verbindungsmöglichkeiten machen dieses Board noch attraktiver für Entwickler, welche eigene Hardwareerweiterungen vermeiden wollen.

Mit dem ADK 2012 wurde auch das AOA Version 2 Protokoll veröffentlicht.
Es fügt die Möglichkeit von Audio Übertragungen über das AOA Protokoll hinzu, wodurch Anwendungen in diesem Gebiet vereinfacht werden.
Accessories können nun auch als Human Interface Devices verwendet werden.
Außerdem kann AOA über Bluetooth verwendet werden. Hierfür wird das Bluetooth Serial Port Profile (SPP) zur Kommunikation genutzt. Für eigene Implementierungen muss somit ein Bluetoothchip der dieses Profil unterstützt verwendet werden.

\lstinputlisting[language=Java]{code/bluetooth.java}
In der Android App kann über die Android Bluetooth Schnittstelle eine Verbindung aufgebaut werden.
\lstinputlisting[language=Java]{code/bluetooth2.java}
Dann kann über Streams mit dem Gerät kommuniziert werden.

\subsection{Das AOA Protokoll}
Um mit einem Android Gerät kommunizieren zu können, müssen mehrere Schritte vom externen Gerät durchgeführt werden.
Das externe Gerät agiert als USB Host und versorgt das Android Gerät mit Strom.
Beim Anschließen wird zunächst überprüft ob das angeschlossene Gerät den Accessory Modus unterstützt.
Wenn dies der Fall ist wird das Gerät auf diesen Modus umgestellt und danach die Kommunikationskanäle aufgebaut.

% Dies geschieht durch einen Request 51 TODO, der zurückliefert welche Version des AOA Protokolls unterstützt wird. Falls keine Antwort zurückkommt, wird das verbundene Geräte ignoriert.
Dafür werden die USB Deskriptoren genutzt, um geeignete USB Endpunkte gefunden werden. AOA benutzt Bulk-Endpunkte. Diese werden bei USB allgemein zum Transport von längeren Block-artigen Datenblöcken benutzt.

Bulk Transfers verwenden CRC zur Fehlererkennung und Korrektur. Es ist garantiert das übertragene Daten korrekt ankommen, es gibt allerdings keine Bandbreite oder Latenz Vorschriften.
\cite{usbbulk}
Nach dem die korrekten Endpunkte gefunden wurde, können sie von dem Accessoir zum senden von Daten verwendet werden.

Auf dem Androidgerät wird daraufhin eine Liste von Applikationen welche die AOA API unterstützen, dem Benutzer gezeigt. Der Benutzer kann dann die zum aktuellen Accessoir passende Applikation auswählen und das angeschlossene Gerät verwenden.
\begin{figure}[h]
\centering
\def\svgwidth{\columnwidth}
\input{media/protocols.pdf_tex}
\end{figure}

Erkannt wird der Accesory Modus, wenn das USB-Interface die Vendor ID 0x18D1 und die Produkt ID von 0x2D00 oder 0x2D01 besitzt. 

\section{Beispiels AOA Anwendung}
Da Android OpenAccessory die von Google offiziell unterstützte API für die Anbindung externer Geräte ist, wird hier auf den Aufbau solcher Applikationen detaillierter eingegangen. Außerdem wird an einer Beispielsapplikation der Aufbau von Systemen, welche auf AOA aufbauen erläutert.
\subsection{AOA Hardware}
Um mit AOA eine Anwendung mit Hardwarekomponente entwickeln zu können, braucht man ein kompatibles Hardwareboard.
Zurzeit können hierfür die von Google als Referenz Plattform bereitgestellten Arduinos, sowie einzelne andere Boards von Drittherstellern, wie zum Beispiel das IOIO Board \cite{ioio}, das AOAA Kit von Embedded Artists\cite{aoaa},  TODO mehr Beispiele , oder man entwickelt die Elektronik basierend auf der Dokumentation des Protokolls selbst\cite{aoaprotocol2}.
Für die Beispielsanwendung wird das IOIO Board benutzt.

\subsection{IOIO Hardware}
Die erste Version des IOIO Boards wurde im September 2011 vorgestellt. Das Board wurde von Ytai Ben-Tsvi, einem Google Angestellten, für eigene Projekte im Rahmen der Google 20\% Zeit entwickelt und als Kooperation mit dem Elektronikunternehmen SparkFun produziert und verkauft.
Es war der erste Board, welches ohne Modifikationen an Android Geräten von diesen verwendet werden konnte, um damit externe Peripherie zu steuern.
Dies wurde über die Verwendung der Android Debug Bridge erreicht, welche als Übertragungsprotokoll verwendet wird.
Als weitere Protokollschicht wurde ein IOIO spezifisches Protokoll entwickelt, mit dem einfache Kommandos übermittelt werden können.
So gibt es Kommandos wie \glqq Schalte Pin 1 ein\grqq, oder \glqq Lese Pin 3 analog\grqq, die durch entsprechende Methoden direkt in der zugehörigen IOIO Android Bibliothek aufgerufen werden können.

Als Mikrocontroller kommt ein PIC24F zum Einsatz, welcher auf Grund seiner vielen Anschlüsse und geringer Kosten gewählt wurde.
Das Board besitzt 48 Pins, welche als Digitale Inputs und Outputs angesteuert werden können. 16 dieser Pins können auch als analoge Inputs verwendet werden.
Zusätzlich können 9 PWM (Pulsweitenmodulation) Ausgänge verwendet werden.
Für die Kommunikation mit anderen Elektronischen Geräten stehen 4 UART Kanäle, 3 SPI Kanäle und 3 TWI Kanäle, welche mit I\textsuperscript{2}C kompatibel sind zur Verfügung.
Der Strom wird über ein externes 5 Volt Netzteil bereitgestellt, welches bis zu 1.5 Ampere liefern muss.

Die externe Stromversorgung ist praktisch, da sowohl das Androidgerät geladen werden kann, als auch Motoren oder ähnliches durch das Netzteil mitversorgt werden können.
Ziel der Neuentwicklung war vor allem eine kostengünstige Möglichkeit zum Einstieg in die Hardware Entwicklung mit Android verfügbar zu machen.
Mit einem Preis von 50\textdollar{} ist das Referenzboard für erste Versuche mit Mikrocontrollern, individuelle Hardwarebastlereien und Prototypen geeignet.
Das Board besitzt einen USB Anschluss, welcher im Host Modus betrieben werden kann, was Voraussetzung für den Betrieb von ADB und AOA ist.

\subsubsection{IOIO-OTG}
Im Sommer 2012 wurde die zweite Version des IOIO Boards veröffentlicht.
Die größte Änderung ist die Möglichkeit das IOIO Board als USB OTG Device zu betreiben.
Dies ermöglicht die Verbindung mit PCs, mit denen das Gerät direkt programmiert werden kann.
Der Entwicklungsprozess wird dadurch vereinfacht, da keine Android Applikation mehr auf dem Gerät installiert werden muss um Programme zu testen.
Die Java Bibliothek wurde so angepasst, dass sie nicht nur unter Android sondern auch mit der Standard JVM verwendbar ist. 
Dadurch können auch Anwendungen, welche den Mikrocontroller vom PC aus verwenden erstellt werden.
Außerdem konnten die Produktionskosten weiter gesenkt werden, die neue Version ist nun bei den Partnerunternehmen des Projektes für ca. 30\textdollar{} erhältlich.

\subsection{Vorhaben}
Mit dem IOIO Board soll eine einfaches Projekt durchgeführt werden, welches Android Geräte an externe Peripherie anbindet.
Das Ziel ist es eine Android App zu entwickeln, welche es ermöglicht einen Atari 2600 zu steuern.
\subsubsection{Atari 2600}
Das Atari Video Computer System (Atari VCS), kurz Atari 2600 ist ein ab 1977 vetriebene Spielekonsole. 
Es war eine der ersten Spielekonsolen, und bis heute mit etwa 30 Millionen verkauften Exemplaren die am meist verkaufte.
Die Hardware ist für heutige Verhältnisse sehr beschränkt. 
So beihaltet die Konsole 128 Byte RAM und einen Prozessor 1,19 MHz Taktfrequenz.
Mit Hilfe von einsteckbaren Modulen können beliebige Spiele ausgeführt werden, von denen etwa 1200 hergestellt wurden.
Angeschlossen wird das System an einen Fernseher, auf dem bis zu 128 verschiedene Farben dargestellt werden.
Es sind zwei Anschlüsse für Controller vorhanden. Von Atari wurden sowohl Standard Joysticks als auch speziellere Eingabegeräte wie Paddles verkauft.

Die Joysticks werden über 9-polige D-Sub Stecker angeschlossen.
eDabei werden bei einem Joystick 5 der Pole für die Verschiedenen Richtungen und den Button verwendet.
Sie funktionieren wie einfache Schalter, von denen maximal drei gedrückt werden können, z.B. 'rechts' + 'oben' + 'Knopf'.
Dabei werden die Pins beim drücken des Joysticks in eine Richtung, von 5 Volt auf 0 Volt heruntergesetzt. 
Dies wird vom Atari als Input erkannt.
Das Ziel ist es also eine Anwendung zu schreiben, mit der von einem Android Handy aus die Spannung an den Input-pins manipuliert werden kann.

\subsection{Umsetzung}
Das IOIO Board wird teilweise ohne funkionsfähige Firmware ausgeliefert. Falls dies der Fall ist, kann man die Firmware von der Github Seite des Projekts beziehen TODO und selbst die Software auf die Hardware flashen.

Um ein solches Hardwareprojekt einfach und schnell umsetzen zu können, sollte man die Komplexität am Anfang beschränken, damit die Fehlersuche vereinfacht wird.
Als einfaches Einstieg, um die Funktionalität des IOIO Board zu überprüfen, bietet es sich an eine LED zu installieren, welche von der Android Applikation angeschaltet wird.

Um die Pins von 5 Volt auf 0 Volt zu bekommen werden fünf der IOIO Digitalausgänge mit den Eingängen eines Transistorarray vom Typ ULN2003A verbunden.

\begin{figure}[h]
%\centering
\def\svgwidth{\columnwidth}
\input{media/circuit.pdf_tex}
\caption{Schaltplan für IOIO Atari Controller}
\end{figure}




Das IOIO Projekt bietet Code Bibliotheken an, welche es ermöglichen das Board mittels Android anzusteuern.
Außerdem gibt es auch eine Desktop Java Bibliothek, die es erlaubt den IOIO von einem PC aus anzusteuern.
Zum entwickeln der Hardwareseitigen Funktionalität bietet es sich daher an, erst auf einem PC zu testen und danach den Code in der Android App zu verwenden.
Die API zur Kommandoübermittlung zum IOIO Board ist recht einfach gehalten.


\subsection{Erkenntnisse}





\section{Ausblick}
Da es für neue Projekte oft wichtig sein kann, dass sie auch in der Zukunft funktionieren, muss vor der Systemkonzeption auch auf die Entwicklung der verwendeten Technologie eingegangen werden.
Nachfolgend wird kurz auf bereits absehbare, voraussichtliche Entwicklungen der verschiedenen Anbindungsmöglichkeiten eingegangen. 
\subsection{AOA}

\subsection{Bluetooth}

\subsection{NFC}

\subsection{USB}
In der Android Version L, welche im Herbst 2014 veröffentlicht wurde, unterstützt USB audio-out. Mit USB Audio-out lässt sich gegenüber den Audioklinkenbuchsen der Smartphone interne Digital-Analog-Umsetzer umgehen, was für Soundtechnikern ermöglicht bessere, externe DAUs zu verwenden.
Damit kann Musik produziert, Mischpulte gesteuert und USB Kopfhörer verwendet werden.
Damit zieht Google mit Apple gleich, welche die Technik schon seit 
Das ermöglicht das Verwenden von USB Geräten  
Um USB audio-out verwenden zu können, wird ein OTG kompatibles Gerät benötigt.

\section{Fazit}






\bibliographystyle{IEEEtran}
\bibliography{android_quotes}

% for the book
\nocite{*}
\end{document}

